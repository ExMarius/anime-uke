<!-- √én login.html, la sf√¢r»ôit √Ænainte de </body> -->
<script src="config.js"></script>
<script src="script.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    console.log('üîê Login page loaded');
    
    const loginForm = document.getElementById('loginForm');
    const errorMessage = document.getElementById('error-message');
    const errorText = document.getElementById('error-text');
    
    // DacƒÉ e deja logat, redirect la home
    if (checkLoginStatus()) {
      console.log('‚úÖ User already logged in, redirecting...');
      window.location.href = 'index.html';
      return;
    }
    
    // Handle form submission
    loginForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      console.log('üìù Form submitted');
      
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      
      // Validate inputs
      if (!username || !password) {
        showError('CompleteazƒÉ ambele c√¢mpuri!');
        return;
      }
      
      // Show loading
      const submitBtn = loginForm.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Se conecteazƒÉ...';
      submitBtn.disabled = true;
      
      console.log(`üîê Attempting login for: ${username}`);
      
      try {
        // Attempt login
        const result = await loginUser(username, password);
        
        if (result.success) {
          console.log('‚úÖ Login successful!');
          showSuccess('Conectat cu succes! Redirec»õionare...');
          
          // Redirect after 1 second
          setTimeout(() => {
            window.location.href = 'index.html';
          }, 1000);
          
        } else {
          console.log('‚ùå Login failed:', result.message);
          showError(result.message);
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        }
        
      } catch (error) {
        console.error('üí• Login error:', error);
        showError('Eroare la conectare. √éncearcƒÉ din nou.');
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }
    });
    
    // Show error function
    function showError(message) {
      errorText.textContent = message;
      errorMessage.className = 'alert alert-danger';
      errorMessage.style.display = 'block';
      
      // Auto-hide after 5 seconds
      setTimeout(() => {
        errorMessage.style.display = 'none';
      }, 5000);
    }
    
    // Show success function
    function showSuccess(message) {
      errorText.textContent = message;
      errorMessage.className = 'alert alert-success';
      errorMessage.style.display = 'block';
    }
    
    // Allow login with Enter key
    document.getElementById('password').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        loginForm.dispatchEvent(new Event('submit'));
      }
    });
    
    console.log('‚úÖ Login page ready');
  });
</script>
